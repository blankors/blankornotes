<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2 Kimball Dimensional Modeling Techniques Overview | 数据仓库工具箱第三版笔记</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="The Data Warehouse Toolkit 3rd Edition">
    
    <link rel="preload" href="/blankornotes/assets/css/0.styles.372fc7a5.css" as="style"><link rel="preload" href="/blankornotes/assets/js/app.14282ac1.js" as="script"><link rel="preload" href="/blankornotes/assets/js/2.a76d4e78.js" as="script"><link rel="preload" href="/blankornotes/assets/js/1.2ec8c7d7.js" as="script"><link rel="preload" href="/blankornotes/assets/js/24.5f4024fd.js" as="script"><link rel="prefetch" href="/blankornotes/assets/js/10.4c178469.js"><link rel="prefetch" href="/blankornotes/assets/js/11.31060eb5.js"><link rel="prefetch" href="/blankornotes/assets/js/12.279f272d.js"><link rel="prefetch" href="/blankornotes/assets/js/13.10227dfa.js"><link rel="prefetch" href="/blankornotes/assets/js/14.fe714d02.js"><link rel="prefetch" href="/blankornotes/assets/js/15.f53ca535.js"><link rel="prefetch" href="/blankornotes/assets/js/16.d3d5bdeb.js"><link rel="prefetch" href="/blankornotes/assets/js/17.4ef2ea13.js"><link rel="prefetch" href="/blankornotes/assets/js/18.37f5f491.js"><link rel="prefetch" href="/blankornotes/assets/js/19.b774cdca.js"><link rel="prefetch" href="/blankornotes/assets/js/20.5d9c4a68.js"><link rel="prefetch" href="/blankornotes/assets/js/21.47844c93.js"><link rel="prefetch" href="/blankornotes/assets/js/22.06fabd8a.js"><link rel="prefetch" href="/blankornotes/assets/js/23.ff8945e2.js"><link rel="prefetch" href="/blankornotes/assets/js/25.61b3ccf4.js"><link rel="prefetch" href="/blankornotes/assets/js/26.5a9d9520.js"><link rel="prefetch" href="/blankornotes/assets/js/27.ca262753.js"><link rel="prefetch" href="/blankornotes/assets/js/3.fb6a4e15.js"><link rel="prefetch" href="/blankornotes/assets/js/4.e9f08a68.js"><link rel="prefetch" href="/blankornotes/assets/js/5.3ffe72e2.js"><link rel="prefetch" href="/blankornotes/assets/js/6.8910dfd2.js"><link rel="prefetch" href="/blankornotes/assets/js/7.d094995e.js"><link rel="prefetch" href="/blankornotes/assets/js/vendors~docsearch.06f5d163.js">
    <link rel="stylesheet" href="/blankornotes/assets/css/0.styles.372fc7a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blankornotes/" class="home-link router-link-active"><!----> <span class="site-name">数据仓库工具箱第三版笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blankornotes/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="blankor的博客" class="dropdown-title"><span class="title">blankor的博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="blankor的博客" class="mobile-dropdown-title"><span class="title">blankor的博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/u012928365" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blankornotes/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="blankor的博客" class="dropdown-title"><span class="title">blankor的博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="blankor的博客" class="mobile-dropdown-title"><span class="title">blankor的博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/u012928365" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blankornotes/" aria-current="page" class="sidebar-link">阅读方式</a></li><li><a href="/blankornotes/ch1.html" class="sidebar-link">第一章</a></li><li><a href="/blankornotes/ch2.html" aria-current="page" class="active sidebar-link">第二章</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#fundamental-concepts-基本概念" class="sidebar-link">Fundamental Concepts 基本概念</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#basic-fact-table-techniques-基本事实表技术" class="sidebar-link">Basic Fact Table Techniques 基本事实表技术</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#basic-dimension-table-techniques-基本维度表技术" class="sidebar-link">Basic Dimension Table Techniques 基本维度表技术</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#integration-via-conformed-dimensions-通过一致性维度进行集成" class="sidebar-link">Integration via Conformed Dimensions 通过一致性维度进行集成</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#dealing-with-slowly-changing-dimension-attributes-处理缓慢变化的维度属性" class="sidebar-link">Dealing with Slowly Changing Dimension Attributes 处理缓慢变化的维度属性</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#dealing-with-dimension-hierarchies-处理维度层次结构" class="sidebar-link">Dealing with Dimension Hierarchies 处理维度层次结构</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#advanced-fact-table-techniques-高级事实表技术" class="sidebar-link">Advanced Fact Table Techniques 高级事实表技术</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#advanced-dimension-techniques-高级维度技术" class="sidebar-link">Advanced Dimension Techniques 高级维度技术</a></li><li class="sidebar-sub-header"><a href="/blankornotes/ch2.html#special-purpose-schemas-特殊目的模式" class="sidebar-link">Special Purpose Schemas 特殊目的模式</a></li></ul></li><li><a href="/blankornotes/ch3.html" class="sidebar-link">第三章</a></li><li><a href="/blankornotes/ch6.html" class="sidebar-link">第六章</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2-kimball-dimensional-modeling-techniques-overview"><a href="#_2-kimball-dimensional-modeling-techniques-overview" class="header-anchor">#</a> 2 Kimball Dimensional Modeling Techniques Overview</h1> <h2 id="fundamental-concepts-基本概念"><a href="#fundamental-concepts-基本概念" class="header-anchor">#</a> Fundamental Concepts 基本概念</h2> <p>本节中的技术在每次维度设计时‘都’必须予以考虑。本书几乎每一章都会提及或阐释本节中的概念。</p> <h3 id="gather-business-requirements-and-data-realities-收集业务需求和数据实际情况"><a href="#gather-business-requirements-and-data-realities-收集业务需求和数据实际情况" class="header-anchor">#</a> Gather Business Requirements and Data Realities 收集业务需求和数据实际情况</h3> <p>在开展维度建模工作之前，团队需要了解业务需求，以及底层源数据的实际情况。通过与‘业务代表’沟通，依据关键绩效指标、重要业务问题、决策过程和支持性分析需求来了解他们的‘目标’，从而揭示业务需求。与此同时，通过与源系统专家交流并进行高级数据剖析，评估数据的可行性，以此揭示数据实际情况。</p> <blockquote><p>Chapter 1 DW/BI and Dimensional Modeling Primer, p 5</p> <p>Chapter 3 Retail Sales, p 70</p> <p>Chapter 11 Telecommunications, p 297</p> <p>Chapter 17 Lifecycle Overview, p 412</p> <p>Chapter 18 Dimensional Modeling Process and Tasks, p 431</p> <p>Chapter 19 ETL Subsystems and Techniques,p 444</p></blockquote> <h3 id="collaborative-dimensional-modeling-workshops-协作式维度建模研讨会"><a href="#collaborative-dimensional-modeling-workshops-协作式维度建模研讨会" class="header-anchor">#</a> Collaborative Dimensional Modeling Workshops 协作式维度建模研讨会</h3> <p>维度模型应与业务领域的主题专家subject matter experts和数据治理代表data governance representatives合作设计。数据建模师负责主导，但模型应通过与业务代表的一系列高度互动的研讨会逐步形成。这些研讨会为与业务方进一步明确需求提供了机会。维度模型不应由不完全了解业务及其需求的人员单独设计，协作至关重要！</p> <h3 id="four-step-dimensional-design-process-四步维度设计流程"><a href="#four-step-dimensional-design-process-四步维度设计流程" class="header-anchor">#</a> Four-Step Dimensional Design Process 四步维度设计流程</h3> <p>设计维度模型时的四个关键决策包括：</p> <ol><li>选择业务流程。</li> <li>声明粒度。</li> <li>识别维度。</li> <li>识别事实。</li></ol> <p>在协作建模会议期间，通过考虑业务需求以及底层源数据的实际情况来确定这些问题的答案。在确定业务流程、粒度、维度和事实后，设计团队确定表名、列名、示例域值和业务规则。业务数据治理代表必须参与这一详细设计活动，以确保业务部门的认可。</p> <h3 id="business-processes-业务流程"><a href="#business-processes-业务流程" class="header-anchor">#</a> Business Processes 业务流程</h3> <p>业务流程（直译的话是商业流程）是组织开展的运营活动<a href="%E4%B8%9A%E5%8A%A1%E6%B5%81%E7%A8%8B%E5%A6%82%E4%BD%95%E5%88%92%E5%88%86%E4%B9%9F%E6%98%AF%E4%B8%AA%E4%B8%8D%E5%B0%8F%E7%9A%84%E9%97%AE%E9%A2%98%E3%80%82">^</a>，例如下订单、处理保险索赔、为学生注册课程或每月对每个账户进行快照。业务流程事件会生成或捕获绩效指标，这些指标会转化为事实表中的事实。大多数事实表聚焦于单个业务流程的结果。选择流程很重要，因为它定义了特定的设计目标，并允许声明粒度、维度和事实。每个业务流程对应企业数据仓库总线矩阵中的一行。</p> <p>如何划分业务流程？</p> <p>“如何划分业务流程”，这是什么方面的知识，有什么书籍或者教程推荐？</p> <h3 id="grain-粒度"><a href="#grain-粒度" class="header-anchor">#</a> Grain 粒度</h3> <p>声明粒度是维度设计中的关键步骤。粒度精确确定了单个事实表行所代表的内容。粒度声明对设计具有约束作用。在选择维度或事实之前必须声明粒度，因为每个候选维度或事实都必须与粒度一致。这种一致性确保了所有维度设计的统一性，这对商业智能（BI）应用程序的性能和易用性至关重要。原子粒度指的是特定业务流程捕获数据的最低级别。我们强烈建议从关注原子粒度数据入手，因为它能够应对不可预测的用户查询；汇总粒度对于性能调优很重要，但它预先假定了业务的常见问题。每个提议的事实表粒度都会生成一个单独的物理表；不同的粒度不能混合在同一个事实表中。</p> <h3 id="dimensions-for-descriptive-context-用于描述性上下文的维度"><a href="#dimensions-for-descriptive-context-用于描述性上下文的维度" class="header-anchor">#</a> Dimensions for Descriptive Context 用于描述性上下文的维度</h3> <p>维度提供了围绕业务流程事件的 “谁、什么、在哪里、何时、为什么以及如何” 等上下文信息。维度表包含 BI 应用程序用于<u>对事实进行筛选和分组的描述性属性</u>。牢记事实表的粒度后，就可以识别所有可能的维度。只要有可能，与给定事实行相关联的维度<strong>应</strong>具有单一值。
维度表有时被称为数据仓库的 “灵魂”，因为它们包含使 DW/BI 系统能够用于业务分析的入口点和描述性标签。由于维度表是用户 BI 体验的驱动因素，因此在数据治理和开发方面会投入大量精力。</p> <h3 id="facts-for-measurements-用于度量的事实"><a href="#facts-for-measurements-用于度量的事实" class="header-anchor">#</a> Facts for Measurements 用于度量的事实</h3> <p>事实是业务流程事件产生的度量结果，<strong>几乎总是</strong>数值型的。单个事实表行与事实表粒度所描述的度量事件存在一一对应关系。因此，事实表对应于一个可观察的物理事件，而不是特定报告的需求。在事实表中，只允许与声明的粒度一致的事实存在。例如，在零售销售交易中，产品的销售数量和扩展价格是合适的事实，而商店经理的工资则不被允许。</p> <h3 id="star-schemas-and-olap-cubes-星型模式和olap立方体"><a href="#star-schemas-and-olap-cubes-星型模式和olap立方体" class="header-anchor">#</a> Star Schemas and OLAP Cubes 星型模式和OLAP立方体</h3> <p>星型模式是部署在关系数据库管理系统（RDBMS）中的维度结构。它们的特点是由事实表通过主键 / 外键关系与相关的维度表链接。在线分析处理（OLAP）立方体是在多维数据库中实现的维度结构；其内容可以与关系星型模式等效，或者更常见的是从关系星型模式派生而来。OLAP 立方体包含维度属性和事实，但它是通过比 SQL 具有更多分析功能的语言（如 XMLA 和 MDX）来访问的。OLAP 立方体被列入基本技术列表，是因为它<strong>通常是</strong>维度 DW/BI 系统部署的最后一步，或者可能作为基于更原子化的关系星型模式的聚合结构而存在。</p> <h3 id="graceful-extensions-to-dimensional-models-维度模型的灵活扩展"><a href="#graceful-extensions-to-dimensional-models-维度模型的灵活扩展" class="header-anchor">#</a> Graceful Extensions to Dimensional Models 维度模型的灵活扩展</h3> <p>维度模型在数据关系发生变化时具有很强的适应性。以下所有的变化都可以在不改变现有 BI 查询或应用程序，且不影响查询结果的情况下实现。</p> <ul><li>与现有事实表粒度一致的新事实，可以通过<u>创建新列</u>的方式添加到事实表中[^2.1.8-1]。</li> <li>在不改变事实表粒度的前提下，通过创建新的外键列，可以向现有事实表中添加维度。</li> <li>可以通过创建新列，向现有维度表中添加属性。</li> <li>通过向现有维度表中添加属性，并重述更低粒度的事实表，同时注意保留事实表和维度表中的现有列名，可使事实表的粒度更细化为原子粒度。</li></ul> <p>[^2.1.8-1]: 在零售销售的场景中，假设最初设计的零售销售事实表包含 “销售数量”“扩展折扣金额”“扩展销售金额”“扩展成本金额” 等事实列，其粒度为每笔销售交易中的单个产品行记录。随着业务发展和分析需求的变化，企业想要分析每笔交易中产品的利润贡献度，而利润贡献度可以通过 “扩展销售金额 - 扩展成本金额” 计算得出。此时，就可以依据 “与现有事实表粒度一致的新事实，可以通过创建新列的方式添加到事实表中” 这一原则，在零售销售事实表中新增 “利润贡献金额” 列来记录该事实。这样，新添加的事实与原事实表的粒度一致，都是基于每笔销售交易中的单个产品，且无需对现有 BI 查询或应用程序进行修改，也不会影响原有查询结果 。</p> <h2 id="basic-fact-table-techniques-基本事实表技术"><a href="#basic-fact-table-techniques-基本事实表技术" class="header-anchor">#</a> Basic Fact Table Techniques 基本事实表技术</h2> <p>本节中的技术适用于<strong>所有</strong>事实表。本书几乎每一章都有事实表的示例。</p> <h3 id="fact-table-structure-事实表结构"><a href="#fact-table-structure-事实表结构" class="header-anchor">#</a> Fact Table Structure 事实表结构</h3> <p>事实表包含现实世界中运营度量事件产生的<u>数值度量</u>。在最低粒度下，事实表中的一行对应一个度量事件，反之亦然。因此，事实表的基本设计<strong>完全</strong>基于实际活动，不受最终可能生成的报告的影响。除了数值度量，事实表总是包含其相关维度的外键，以及可选的退化维度键和日期 / 时间戳。事实表是查询产生的计算和动态聚合的<strong>主要目标</strong>。</p> <h3 id="additive-semi-additive-non-additive-facts-可加性、半可加性、不可加性事实"><a href="#additive-semi-additive-non-additive-facts-可加性、半可加性、不可加性事实" class="header-anchor">#</a> Additive, Semi-Additive, Non-Additive Facts 可加性、半可加性、不可加性事实</h3> <p>事实表中的数值度量分为三类。最灵活且最有用的事实是完全可加的；可加性度量可以在与事实表相关的任何维度上进行求和。半可加性度量可以在某些维度上求和，但并非所有维度；余额金额就是常见的半可加性事实，因为它们在除时间维度之外的所有维度上都是可加的。最后，有些度量是完全不可加的，例如比率。对于不可加性事实，一种可行的方法是，在可能的情况下，存储不可加性度量的完全可加组件，并在计算最终的不可加性事实之前，将这些组件相加以生成最终的答案集。这种最终计算通常在 BI 层或 OLAP 立方体中完成。</p> <h3 id="nulls-in-fact-tables-事实表中的空值"><a href="#nulls-in-fact-tables-事实表中的空值" class="header-anchor">#</a> Nulls in Fact Tables 事实表中的空值</h3> <p>在事实表中，空值度量的表现较为<strong>正常</strong>。聚合函数（SUM、COUNT、MIN、MAX 和 AVG）在处理空值事实时都能做出 “正确的处理”。但是，事实表的外键中<strong>必须避免</strong>出现空值，因为这些空值会自动导致参照完整性违规a referential integrity violation。对于空的外键，相关的维度表必须有一个默认行（和代理键）来表示未知或不适用的情况。</p> <h3 id="conformed-facts-一致性事实"><a href="#conformed-facts-一致性事实" class="header-anchor">#</a> Conformed Facts 一致性事实</h3> <p>如果同一度量出现在不同的事实表中，若要将它们进行比较或一起计算，必须确保这些事实的技术定义是相同的。如果不同的事实定义一致，那么一致性事实应该具有相同的名称；但如果它们不兼容，则应该使用不同的名称，以提醒业务用户和 BI 应用程序。</p> <h3 id="transaction-fact-tables-事务事实表"><a href="#transaction-fact-tables-事务事实表" class="header-anchor">#</a> Transaction Fact Tables 事务事实表</h3> <p>事务事实表中的一行对应于<u>某‘个’时间和空间点上的度量事件</u>。原子事务粒度的事实表是维度最多、表达能力最强的事实表；这种强大的维度性使得对事务数据的切片和切块分析达到最大程度。事务事实表可能是密集的，也可能是稀疏的，因为只有在进行度量时才会存在行记录。这些事实表总是包含每个相关维度的外键，并且可选地包含精确的时间戳和退化维度键。度量的数值事实必须与事务粒度一致。</p> <blockquote><p>Chapter 3 Retail Sales , p 79</p> <p>Chapter 4 Inventory , p 116</p> <p>Chapter 5 Procurement , p 142</p> <p>Chapter 6 Order Management , p 168</p> <p>Chapter 7 Accounting , p 206</p> <p>Chapter 11 Telecommunications , p 306</p> <p>Chapter 12 Transportation , p 312</p> <p>Chapter 14 Healthcare , p 351</p> <p>Chapter 15 Electronic Commerce , p 363</p> <p>Chapter 16 Insurance , p 379</p> <p>Chapter 19 ETL Subsystems and Techniques , p 473</p></blockquote> <h3 id="periodic-snapshot-fact-tables-周期快照事实表"><a href="#periodic-snapshot-fact-tables-周期快照事实表" class="header-anchor">#</a> Periodic Snapshot Fact Tables 周期快照事实表</h3> <p>周期快照事实表中的一行汇总了<u>在一个标准时间段（如一天、一周或一个月）内发生的许多度量事件</u>。其粒度是时间段，而不是单个事务。周期快照事实表通常包含许多事实，因为任何与事实表粒度一致的度量事件都是允许的。这些事实表的外键分布均匀且密集，因为即使在该时间段内没有活动发生，通常也会在事实表中插入一行，其中每个事实列的值为零或空值。</p> <h3 id="accumulating-snapshot-fact-tables-累积快照事实表"><a href="#accumulating-snapshot-fact-tables-累积快照事实表" class="header-anchor">#</a> Accumulating Snapshot Fact Tables 累积快照事实表</h3> <p>累积快照事实表中的一行汇总了<u>在一个过程的开始和结束之间的可预测步骤中发生的度量事件</u>。具有定义明确的起点、标准中间步骤和定义明确的终点的流程或工作流过程，如订单履行或索赔处理，可以使用这种类型的事实表进行建模。在事实表中，每个关键过程步骤都有一个日期外键。例如，与订单行对应的累积快照事实表中的单个行，在订单行创建时插入。随着流程的推进，会再次访问并更新累积事实表行。在三种类型的事实表中，累积快照事实表行的这种持续更新是独一无二的。除了与每个关键过程步骤相关的日期外键，累积快照事实表还包含其他维度的外键，并且可选地包含退化维度。它们通常包括与粒度一致的数值滞后度量，以及里程碑完成计数器。</p> <h3 id="factless-fact-tables-无事实事实表"><a href="#factless-fact-tables-无事实事实表" class="header-anchor">#</a> Factless Fact Tables 无事实事实表</h3> <p>虽然大多数度量事件会捕获数值结果，但也有可能该事件仅仅记录了一组维度实体在某个时刻的组合情况。例如，学生在某一天上课的事件可能没有记录数值事实，但包含日历日、学生、教师、地点和课程等外键的事实行是明确的。同样，客户通信也是事件，但可能没有相关的度量。无事实事实表也可用于分析未发生的事情。这些查询<strong>通常分为</strong>两部分：</p> <ul><li>一个无事实覆盖表a factless coverage table ，包含所有可能发生的事件的可能性；</li> <li>一个活动表an activity table，包含实际发生的事件。当从覆盖表中减去活动表的内容时，结果就是未发生的事件集。</li></ul> <h3 id="aggregate-fact-tables-or-olap-cubes-聚合事实表或olap立方体"><a href="#aggregate-fact-tables-or-olap-cubes-聚合事实表或olap立方体" class="header-anchor">#</a> Aggregate Fact Tables or OLAP Cubes 聚合事实表或OLAP立方体</h3> <p>聚合事实表是对原子事实表数据进行简单的数值汇总，其构建目的仅为加快查询性能。这些聚合事实表应与原子事实表同时提供给 BI 层，以便 BI 工具在查询时能顺利选择合适的聚合级别。这个过程被称为聚合导航，它必须是开放的，这样每个报表编写器、查询工具和 BI 应用程序都能获得相同的性能提升。一组设计合理的聚合应像数据库索引一样，能加速查询性能，但不会被 BI 应用程序或业务用户直接接触到。聚合事实表包含指向缩减的一致性维度的外键，以及通过对更原子化的事实表中的度量进行求和而创建的聚合事实。最后，带有汇总度量的聚合 OLAP 立方体通常以与关系型聚合相同的方式构建，但 OLAP 立方体是供业务用户直接访问的。</p> <h3 id="consolidated-fact-tables-合并事实表"><a href="#consolidated-fact-tables-合并事实表" class="header-anchor">#</a> Consolidated Fact Tables 合并事实表</h3> <p>如果来自多个业务流程的事实能够在相同粒度下进行表达，将它们合并到一个单独的合并事实表中通常会很方便。例如，销售实际数据可以与销售预测数据合并到一个事实表中，相较于使用单独的事实表来构建跨钻分析应用程序，这种方式能使对比分析实际数据与预测数据的任务变得更加简单和快速。合并事实表会增加 ETL 处理的负担，但能减轻 BI 应用程序的分析负担。对于那些经常需要一起分析的跨流程指标，应该考虑使用合并事实表。</p> <h2 id="basic-dimension-table-techniques-基本维度表技术"><a href="#basic-dimension-table-techniques-基本维度表技术" class="header-anchor">#</a> Basic Dimension Table Techniques 基本维度表技术</h2> <h3 id="dimension-table-structure-维度表结构"><a href="#dimension-table-structure-维度表结构" class="header-anchor">#</a> Dimension Table Structure 维度表结构</h3> <p>每个维度表都有一个单一的主键列。这个主键会作为外键嵌入到任何与之相关联的事实表中，在这些事实表中，<u>维度行的描述性上下文</u>对于事实表的行来说是完全准确适配的。维度表通常是宽表、扁平化的非规范化表，包含许多低基数的文本属性。虽然操作型代码和指标可以被当作属性来处理，但最有效的维度属性是填充了详细描述的那些属性。维度表的属性是来自查询和商业智能（BI）应用程序的约束和分组规范的主要目标。报表上的描述性标签通常是维度属性的域值。</p> <blockquote><p>Chapter 1 DW/BI and Dimensional Modeling Primer , p 13</p> <p>Chapter 3 Retail Sales , p 79</p> <p>Chapter 11 Telecommunications , p 301</p></blockquote> <h3 id="dimension-surrogate-keys-维度代理键"><a href="#dimension-surrogate-keys-维度代理键" class="header-anchor">#</a> Dimension Surrogate Keys 维度代理键</h3> <p>维度表的设计是让其中一列充当唯一的主键。这个主键<strong>不能是</strong>操作系统the operational system的自然键 natural key，因为当随时间追踪变化时，对于那个自然键来说会存在多个维度行<a href="%E9%9A%8F%E7%9D%80%E6%97%B6%E9%97%B4%E8%BF%BD%E8%B8%AA%E5%8F%98%E5%8C%96%E6%97%B6%EF%BC%8C%E4%B8%80%E4%B8%AA%E8%87%AA%E7%84%B6%E9%94%AE%E4%BC%9A%E5%AD%98%E5%9C%A8%E5%A4%9A%E4%B8%AA%E7%BB%B4%E5%BA%A6%E8%A1%8C%EF%BC%8C%E4%B8%BB%E8%A6%81%E5%8E%9F%E5%9B%A0%E6%9C%89%E4%B8%A4%E7%82%B9%EF%BC%9A">^2.3.2-1</a>。此外，一个维度的自然键可能由不止一个源系统创建，而且这些自然键可能不兼容，或者管理不善。数据仓库/商业智能（DW/BI）系统需要对所有维度的主键进行管控；你<strong>不应</strong>使用明确的自然键或附加了日期的自然键，而<strong>应该</strong>为每个维度创建<u>匿名的整数主键</u>anonymous integer primary keys<a href="%E5%8C%BF%E5%90%8D%E6%95%B4%E6%95%B0%E4%B8%BB%E9%94%AE%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E5%A6%82%E4%B8%8B%EF%BC%9A">^2.3.2-2</a>。这些维度代理键<strong>是</strong>简单的整数，每次需要新键时，从数值1开始按顺序分配。日期维度不受代理键规则的限制；这个高度可预测且稳定的维度可以使用更有意义的主键。请参阅“日历日期维度”这一节。</p> <blockquote><p>Chapter 1 DW/BI and Dimensional Modeling Primer, p 13</p> <p>Chapter 3 Retail Sales, p 79</p> <p>Chapter 11 Telecommunications , p 301</p></blockquote> <ul><li><strong>业务实体属性变化</strong>：在实际业务场景中，业务实体的属性会发生变化。以产品为例，产品的所属部门可能会调整，在操作型系统里，这一变化可能不会改变产品的自然键，但从维度表的角度，如果要准确记录历史变化，采用类型2（Type 2）的处理方式就会为该产品添加新的维度行 。假设产品A最初属于部门X，自然键为A001，之后调整到部门Y，在记录变化时就会插入新的维度行，两行都对应自然键A001，这样就出现了一个自然键对应多个维度行的情况。</li> <li><strong>源系统不一致</strong>：一个维度的自然键可能由多个源系统创建。不同的源系统对业务实体的定义和管理方式有差异，产生的自然键可能存在不兼容或管理不善的问题。在合并来自不同源系统的数据时，即使是代表同一业务实体的自然键，也可能因为编码规则、格式等不一致，被当作不同的键来处理，从而在维度表中为同一个实际的业务实体创建多个维度行，对应到同一个自然键。</li></ul> <ul><li><strong>顺序分配</strong>：在需要填充维度时，按顺序依次分配整数作为匿名整数主键。比如在产品维度表中，首个产品行的主键被赋予1，下一个产品行的主键则为2，依此类推。这种分配方式简单直接，能确保主键的唯一性。</li> <li><strong>借助ETL系统</strong>：在ETL（Extract, Transformation, Load）系统中建立并维护一个交叉引用表，用于在事实表和维度表的每一行中替换合适的代理键（即匿名整数主键）。这一过程涉及到对源数据的提取、转换和加载操作，通过交叉引用表，ETL系统能够准确地将每个维度表中的自然键与相应的匿名整数主键进行映射和替换，从而实现维度表与事实表之间基于匿名整数主键的关联。</li> <li><strong>处理特殊情况</strong>：针对一些特殊情况，如维度条件没有操作代码（像“无促销”条件或匿名客户），或事实表中有待定日期时，会分配特殊的代理键值来进行记录。这些特殊的代理键值同样是匿名整数主键的一部分，确保了数据的完整性和一致性。</li></ul> <h3 id="natural-durable-and-supernatural-keys-自然键、持久键和超自然键"><a href="#natural-durable-and-supernatural-keys-自然键、持久键和超自然键" class="header-anchor">#</a> Natural, Durable, and Supernatural Keys 自然键、持久键和超自然键</h3> <p>由操作源系统创建的自然键受<u>数据仓库/商业智能（DW/BI）系统无法控制的业务规则</u>的影响。例如，如果一名员工辞职后又被重新聘用，其员工编号（自然键）可能会发生变化。当数据仓库希望为该员工设置一个单一的键时，就必须创建一个新的持久键，这个键在这种情况下是持续有效且不会改变的。这种键有时被称为持久超自然键。<strong>最佳</strong>的持久键应具有一种独立于原始业务流程的格式，因此应该是从1开始按顺序分配的简单整数。随着时间推移，由于员工的个人信息发生变化，可能会有多个代理键与该员工相关联，但持久键永远不会改变。</p> <h3 id="drilling-down-向下钻取"><a href="#drilling-down-向下钻取" class="header-anchor">#</a> Drilling Down 向下钻取</h3> <p>向下钻取是业务用户分析数据的最基本方式。向下钻取简单来说就是在现有查询中添加一个行标题；这个新的行标题是一个维度属性，添加到SQL查询的GROUP BY表达式中。该属性可以来自查询中与事实表相关联的任何维度。向下钻取不需要预先定义层次结构或钻取路径。详见“跨钻取（Drilling Across）”一节。</p> <h3 id="degenerate-2-3-4-1-dimensions-退化维度"><a href="#degenerate-2-3-4-1-dimensions-退化维度" class="header-anchor">#</a> Degenerate[^2.3.4-1] Dimensions 退化维度</h3> <p>有时，定义的某个维度除了主键之外没有其他内容。例如，当一张发票有多个行项目时，行项目事实行继承了发票的所有描述性维度外键，而发票本身没有独特的内容。但是发票编号对于行项目级别的事实表来说，仍然是一个有效的维度键。这个退化维度被放入事实表中，并且明确表示没有与之关联的维度表。退化维度在事务事实表和累积快照事实表中最为常见。</p> <p>[^2.3.4-1]: to become worse in quality</p> <table><thead><tr><th>订单行项目事实表</th> <th>说明</th></tr></thead> <tbody><tr><td>订单编号（退化维度）</td> <td>1.作为订单行项目事实表的退化维度，用于唯一标识每个订单，在操作型数据库中，它原本可能是订单头记录的关键，<br>2.但在维度模型中，其相关描述信息已被提取到其他维度表，这里仅作为一个没有关联维度表的维度键存在</td></tr> <tr><td>产品键（外键）</td> <td>关联产品表的主键，用于表明该订单行项目对应的产品</td></tr> <tr><td>客户键（外键）</td> <td>关联客户表的主键，用于表明购买产品的客户</td></tr> <tr><td>日期键（外键）</td> <td>关联日期表的主键，用于记录订单发生的日期</td></tr> <tr><td>销售数量</td> <td>该订单行项目中产品的销售数量</td></tr> <tr><td>销售金额</td> <td>该订单行项目中产品的销售金额</td></tr> <tr><td>......</td> <td>其他相关事实字段</td></tr> <tr><td></td> <td></td></tr> <tr><td><strong>产品表</strong></td> <td>说明</td></tr> <tr><td>----</td> <td>----</td></tr> <tr><td>产品键（主键）</td> <td>唯一标识每个产品</td></tr> <tr><td>产品名称</td> <td>产品的具体名称</td></tr> <tr><td>产品类别</td> <td>产品所属的类别</td></tr> <tr><td>......</td> <td>其他产品相关描述信息</td></tr> <tr><td></td> <td></td></tr> <tr><td><strong>客户表</strong></td> <td>说明</td></tr> <tr><td>----</td> <td>----</td></tr> <tr><td>客户键（主键）</td> <td>唯一标识每个客户</td></tr> <tr><td>客户名称</td> <td>客户的名称</td></tr> <tr><td>客户地址</td> <td>客户的地址</td></tr> <tr><td>......</td> <td>其他客户相关描述信息</td></tr> <tr><td></td> <td></td></tr> <tr><td><strong>日期表</strong></td> <td>说明</td></tr> <tr><td>----</td> <td>----</td></tr> <tr><td>日期键（主键）</td> <td>唯一标识每个日期</td></tr> <tr><td>日期</td> <td>具体的年月日</td></tr> <tr><td>星期几</td> <td>该日期对应的星期几</td></tr> <tr><td>......</td> <td>其他日期相关描述信息</td></tr></tbody></table> <p>在这个例子中，订单编号就是一个退化维度。在实际业务中，订单可能包含多个行项目，每个行项目都继承了订单的相关描述性维度外键（如客户、日期等信息），而订单编号本身除了作为区分不同订单的标识外，在这个事实表中没有其他额外的描述内容，也没有与之对应的维度表，但它对事实表中数据的关联和查询起到重要作用，比如可以通过订单编号将同一订单下的所有行项目数据关联起来进行分析。</p> <h3 id="denormalized-flattened-dimensions-非规范化扁平维度"><a href="#denormalized-flattened-dimensions-非规范化扁平维度" class="header-anchor">#</a> Denormalized Flattened Dimensions 非规范化扁平维度</h3> <p>一般来说，维度设计师必须抵制<u>因多年操作型数据库设计而产生的规范化冲动</u>，而是要将多对一的固定深度层次结构非规范化处理，将其转化为扁平维度行上的单独属性。维度非规范化有助于实现维度建模的两个目标：简单性和速度。</p> <h3 id="multiple-hierarchies-in-dimensions-维度中的多个层次结构"><a href="#multiple-hierarchies-in-dimensions-维度中的多个层次结构" class="header-anchor">#</a> Multiple Hierarchies in Dimensions 维度中的多个层次结构</h3> <p>许多维度包含不止一个自然层次结构。例如，日历日期维度可能有从日到周再到财年期间的层次结构，也有从日到月再到年的层次结构。与地理位置密切相关的维度可能存在多个地理层次结构。在所有这些情况下，不同的层次结构可以在同一个维度表中和谐共存。</p> <h3 id="flags-and-indicators-as-textual-attributes-作为文本属性的标志和指标"><a href="#flags-and-indicators-as-textual-attributes-作为文本属性的标志和指标" class="header-anchor">#</a> Flags and Indicators as Textual Attributes 作为文本属性的标志和指标</h3> <p>在维度表中，神秘的缩写Cryptic abbreviations、真假标志true/false <strong>flags</strong>以及操作指示符operational <strong>indicators</strong>都<strong>应该</strong>用<u>独立来看就有意义的完整文本词汇</u>加以补充。代码值中蕴含特定含义的操作代码Operational codes with embedded meaning within the code value应该被拆解broken down，代码的每个部分都要扩展成各自独立的描述性维度属性its own separate descriptive dimension attribute。</p> <p>在零售行业的销售数据维度建模中，假设存在一个“促销维度” ，该维度用于描述产品销售时的促销条件。在这个维度中：</p> <ul><li><strong>Cryptic abbreviations（隐晦缩写）</strong>：假设在原始数据中，用“TPR”代表“Temporary Price Reduction”（临时降价）。这对于不熟悉该缩写的人来说，很难直接理解其含义。按照建议优化后，应直接使用“Temporary Price Reduction”来表示，使含义清晰明确。</li> <li><strong>true/false flags（布尔标志）</strong>：比如有一个标志位，用“Y”和“N”来表示产品是否参与了特定促销活动。“Y”代表参与，“N”代表未参与。这种表示方式不够直观，优化后可以用“Participated in Promotion”（参与促销）和“Did Not Participate in Promotion”（未参与促销）来替代，让业务用户能更清楚地理解数据含义。</li> <li><strong>operational indicators（操作指标）</strong>：假设存在一个操作指标“DISP”，用于表示产品在店内的展示方式，“DISP1”表示端架展示，“DISP2”表示普通货架展示 。这样的代码缺乏直观性，优化时应将其扩展为单独的描述性维度属性，如“Display Type: End Aisle Display”（展示类型：端架展示）和“Display Type: Regular Shelf Display”（展示类型：普通货架展示）。</li></ul> <p>通过以上优化，将隐晦缩写、布尔标志和操作指标替换为完整的文本描述，使维度表中的数据更易于理解和使用，符合文本中关于维度表设计的建议，能更好地支持业务分析和查询。</p> <h3 id="null-attributes-in-dimensions-维度中的空属性"><a href="#null-attributes-in-dimensions-维度中的空属性" class="header-anchor">#</a> Null Attributes in Dimensions 维度中的空属性</h3> <p>当某个维度行未被完全填充，或者存在并非适用于该维度所有行的属性时，就会出现维度属性的空值情况。在这两种情况下，我们建议用诸如“未知”或“不适用”等描述性字符串来替代空值。应避免维度属性中出现空值，因为不同数据库对空值的分组和约束处理方式并不一致。</p> <h3 id="calendar-date-dimensions-日历日期维度"><a href="#calendar-date-dimensions-日历日期维度" class="header-anchor">#</a> Calendar Date Dimensions 日历日期维度</h3> <p>日历日期维度几乎会附加到每个事实表上，以便通过人们熟悉的日期、月份、财务期间和日历上的特殊日子来浏览事实表。你肯定不想在SQL中计算复活节的日期，而是希望在日历日期维度中查找。日历日期维度通常包含许多描述性属性，如周数、月份名称、财务期间和国家法定节假日指示符。为便于分区，日期维度的主键<strong>可以</strong>更具意义，例如用代表YYYYMMDD的整数，而不是顺序分配的代理键。不过，日期维度表需要一个特殊的行来表示未知或待定的日期。当需要更高的精度时，<strong>可以</strong>在事实表中添加一个单独的日期/时间戳。日期/时间戳不是维度表的外键，而是一个独立的列。如果业务用户根据诸如时段分组或班次编号等时间属性进行筛选或分组，那么就<strong>需要</strong>在事实表中添加一个单独的时间维度外键。</p> <h3 id="role-playing-dimensions-角色维度"><a href="#role-playing-dimensions-角色维度" class="header-anchor">#</a> Role-Playing Dimensions 角色维度</h3> <p>一个物理维度可以在事实表中被多次引用，且每次引用都与该维度在逻辑上不同的角色相关联。例如，一个事实表可能会有多个日期，每个日期都由指向日期维度的外键来表示。至关重要的是，每个外键<strong>都应</strong>指向日期维度的一个独立视图，这样这些引用才是相互独立的。这些独立的维度视图（具有唯一的属性列名称）被称为角色。</p> <h3 id="junk-dimensions-垃圾维度"><a href="#junk-dimensions-垃圾维度" class="header-anchor">#</a> Junk Dimensions 垃圾维度</h3> <p>事务性业务流程通常会产生一些各种各样的、基数较低的标志和指标。与其为每个标志和属性分别创建单独的维度，不如创建一个将它们组合在一起的单一 “垃圾维度”。在模式中，这个维度通常被标记为事务概况维度，它无需是所有属性可能值的笛卡尔积，而只需包含源数据中实际出现的属性值组合。</p> <h3 id="snowflaked-dimensions-雪花维度"><a href="#snowflaked-dimensions-雪花维度" class="header-anchor">#</a> Snowflaked Dimensions 雪花维度</h3> <p>当维度表中的层次关系被规范化时，低基数属性会以辅助表的形式出现，这些辅助表通过属性键与基础维度表相连。当对维度表中的所有层次结构都重复这一过程时，就会创建出<u>一种具有特征性的多层结构</u><a href="%E4%B8%9A%E5%8A%A1%E6%B5%81%E7%A8%8B%E5%A6%82%E4%BD%95%E5%88%92%E5%88%86%E4%B9%9F%E6%98%AF%E4%B8%AA%E4%B8%8D%E5%B0%8F%E7%9A%84%E9%97%AE%E9%A2%98%E3%80%82">^</a>，这种结构被称为雪花模式。尽管雪花模式能准确地表示层次数据，但你应该<strong>避免</strong>使用雪花模式，因为业务用户很难理解和浏览雪花模式，而且它还可能对查询性能产生负面影响。一个扁平化的非规范化维度表所包含的信息与雪花状维度表的信息完全相同。</p> <p>在第3章“零售销售”和第11章“电信”中，会进一步讨论雪花型维度，在第20章“ETL系统设计与开发过程和任务”中，也会涉及相关内容。</p> <p>以下是一个雪花模式的例子，以电商公司的销售数据为例进行说明：</p> <ul><li><strong>核心维度表 - 商品表（Product）</strong>：包含商品的基本信息，如商品编号（ProductID）、商品名称（ProductName）、品牌（Brand）等。</li> <li><strong>一级扩展维度表 - 商品分类表（ProductCategory）</strong>：存储商品的分类信息，设有分类编号（CategoryID）、分类名称（CategoryName）以及外键商品编号（ProductID），通过商品编号与商品表关联，这样可以表示商品属于哪个分类，例如“手机”属于“数码产品”分类。</li> <li><strong>二级扩展维度表 - 分类层级表（CategoryHierarchy）</strong>：用于进一步描述商品分类的层次关系，有层级编号（HierarchyID）、上级分类编号（ParentCategoryID）、下级分类编号（ChildCategoryID）等字段。通过这个表可以体现出分类的层级结构，比如“数码产品”是“电子产品”的下级分类，“手机”又是“数码产品”的下级分类。</li></ul> <p>在这个例子中，商品表是核心维度表，商品分类表和分类层级表是围绕商品表展开的扩展维度表，它们之间通过键相互关联，形成了类似雪花的结构。这种结构虽然能清晰地表示商品及其分类的层次关系，但如果业务人员想要查询某个品牌下所有商品在各个分类层级中的销售情况，就需要关联多个表，查询过程会比较复杂，而且性能可能受到影响。</p> <h3 id="outrigger-dimensions-外扩维度"><a href="#outrigger-dimensions-外扩维度" class="header-anchor">#</a> Outrigger Dimensions 外扩维度</h3> <p>一个维度可以包含对另一个维度表的引用。例如，银行账户维度可以引用一个单独的维度，该维度表示账户的开户日期。这些对二级维度的引用被称为 “外伸维度”。外伸维度是可行的，但应该谨慎使用。在大多数情况下，维度之间的关联关系应下放到事实表中，在事实表中，两个维度都以独立的外键形式呈现。</p> <h2 id="integration-via-conformed-dimensions-通过一致性维度进行集成"><a href="#integration-via-conformed-dimensions-通过一致性维度进行集成" class="header-anchor">#</a> Integration via Conformed Dimensions 通过一致性维度进行集成</h2> <h2 id="dealing-with-slowly-changing-dimension-attributes-处理缓慢变化的维度属性"><a href="#dealing-with-slowly-changing-dimension-attributes-处理缓慢变化的维度属性" class="header-anchor">#</a> Dealing with Slowly Changing Dimension Attributes 处理缓慢变化的维度属性</h2> <p>以下部分介绍了处理缓慢变化维度（SCD）属性的基本方法。在同一个维度表中，存在使用不同变化跟踪技术change tracking techniques来处理的属性，这是相当常见的情况。</p> <h3 id="type-0-retain-original-类型0-保留原始值"><a href="#type-0-retain-original-类型0-保留原始值" class="header-anchor">#</a> Type 0: Retain Original 类型0 保留原始值</h3> <p>在类型 0 的情况下，维度属性值永远不会改变，因此事实数据总是按照这个原始值进行分组。类型 0 适用于任何标记为 “原始” 的属性，例如客户的原始信用评分或持久标识符。它也适用于日期维度中的大多数属性。</p> <h3 id="type-1-overwrite-类型1-覆盖"><a href="#type-1-overwrite-类型1-覆盖" class="header-anchor">#</a> Type 1: Overwrite 类型1 覆盖</h3> <p>在类型 1 的情况下，维度行中的旧属性值会被新值覆盖；类型 1 的属性始终反映最新的赋值，因此这种技术会破坏历史数据。尽管这种方法易于实现，并且不会创建额外的维度行，但必须注意，受此更改影响的聚合事实表和联机分析处理（OLAP）立方体需要重新计算。</p> <h3 id="type-2-add-new-row-类型2-添加新行"><a href="#type-2-add-new-row-类型2-添加新行" class="header-anchor">#</a> Type 2: Add New Row 类型2 添加新行</h3> <p>类型 2 的变化会在维度中添加一行带有更新后属性值的新行。这就需要将维度的主键扩展到超出自然键或持久键的范畴，因为可能会有多行来描述每个成员。
当为某个维度成员创建新行时，会分配一个新的代理主键，并从更新时刻起将其用作所有事实表中的外键，直到后续的更改创建一个新的维度键和更新后的维度行。
对于类型 2 的变化，维度行中至少应添加三列：1）行生效日期或日期 / 时间戳；2）行过期日期或日期 / 时间戳；3）当前行指示器。</p> <h3 id="type-3-add-new-attribute-类型3-添加新属性"><a href="#type-3-add-new-attribute-类型3-添加新属性" class="header-anchor">#</a> Type 3: Add New Attribute 类型3 添加新属性</h3> <h3 id="type-4-add-mini-dimension-类型4-添加迷你维度"><a href="#type-4-add-mini-dimension-类型4-添加迷你维度" class="header-anchor">#</a> Type 4: Add Mini-Dimension 类型4 添加迷你维度</h3> <h3 id="type-5-add-mini-dimension-and-type-1-outrigger-类型5-添加迷你维度和类型1外扩"><a href="#type-5-add-mini-dimension-and-type-1-outrigger-类型5-添加迷你维度和类型1外扩" class="header-anchor">#</a> Type 5: Add Mini-Dimension and Type 1 Outrigger 类型5 添加迷你维度和类型1外扩</h3> <h3 id="type-6-add-type-1-attributes-to-type-2-dimension-类型6-向类型2维度添加类型1属性"><a href="#type-6-add-type-1-attributes-to-type-2-dimension-类型6-向类型2维度添加类型1属性" class="header-anchor">#</a> Type 6: Add Type 1 Attributes to Type 2 Dimension 类型6 向类型2维度添加类型1属性</h3> <h3 id="type-7-dual-type-1-and-type-2-dimensions-类型7-双类型1和类型2维度"><a href="#type-7-dual-type-1-and-type-2-dimensions-类型7-双类型1和类型2维度" class="header-anchor">#</a> Type 7: Dual Type 1 and Type 2 Dimensions 类型7 双类型1和类型2维度</h3> <h2 id="dealing-with-dimension-hierarchies-处理维度层次结构"><a href="#dealing-with-dimension-hierarchies-处理维度层次结构" class="header-anchor">#</a> Dealing with Dimension Hierarchies 处理维度层次结构</h2> <h3 id="fixed-depth-positional-hierarchies-固定深度位置层次结构"><a href="#fixed-depth-positional-hierarchies-固定深度位置层次结构" class="header-anchor">#</a> Fixed Depth Positional Hierarchies 固定深度位置层次结构</h3> <h3 id="slightly-ragged-variable-depth-hierarchies-略不规则-可变深度层次结构"><a href="#slightly-ragged-variable-depth-hierarchies-略不规则-可变深度层次结构" class="header-anchor">#</a> Slightly Ragged/Variable Depth Hierarchies 略不规则/可变深度层次结构</h3> <h3 id="ragged-variable-depth-hierarchies-with-hierarchy-bridge-tables-具有层次结构桥接表的不规则-可变深度层次结构"><a href="#ragged-variable-depth-hierarchies-with-hierarchy-bridge-tables-具有层次结构桥接表的不规则-可变深度层次结构" class="header-anchor">#</a> Ragged/Variable Depth Hierarchies with Hierarchy Bridge Tables 具有层次结构桥接表的不规则/可变深度层次结构</h3> <h3 id="ragged-variable-depth-hierarchies-with-pathstring-attributes-具有路径字符串属性的不规则-可变深度层次结构"><a href="#ragged-variable-depth-hierarchies-with-pathstring-attributes-具有路径字符串属性的不规则-可变深度层次结构" class="header-anchor">#</a> Ragged/Variable Depth Hierarchies with Pathstring Attributes 具有路径字符串属性的不规则/可变深度层次结构</h3> <h2 id="advanced-fact-table-techniques-高级事实表技术"><a href="#advanced-fact-table-techniques-高级事实表技术" class="header-anchor">#</a> Advanced Fact Table Techniques 高级事实表技术</h2> <h3 id="fact-table-surrogate-keys-事实表代理键"><a href="#fact-table-surrogate-keys-事实表代理键" class="header-anchor">#</a> Fact Table Surrogate Keys 事实表代理键</h3> <h3 id="centipede-fact-tables-蜈蚣型事实表"><a href="#centipede-fact-tables-蜈蚣型事实表" class="header-anchor">#</a> Centipede Fact Tables 蜈蚣型事实表</h3> <h3 id="numeric-values-as-attributes-or-facts-作为属性或事实的数值"><a href="#numeric-values-as-attributes-or-facts-作为属性或事实的数值" class="header-anchor">#</a> Numeric Values as Attributes or Facts 作为属性或事实的数值</h3> <h3 id="lag-duration-facts-滞后-持续时间事实"><a href="#lag-duration-facts-滞后-持续时间事实" class="header-anchor">#</a> Lag/Duration Facts 滞后/持续时间事实</h3> <h3 id="header-line-fact-tables-标题-行事实表"><a href="#header-line-fact-tables-标题-行事实表" class="header-anchor">#</a> Header/Line Fact Tables 标题/行事实表</h3> <h3 id="allocated-facts-分摊事实"><a href="#allocated-facts-分摊事实" class="header-anchor">#</a> Allocated Facts 分摊事实</h3> <h3 id="profit-and-loss-fact-tables-using-allocations-使用分摊的损益事实表"><a href="#profit-and-loss-fact-tables-using-allocations-使用分摊的损益事实表" class="header-anchor">#</a> Profit and Loss Fact Tables Using Allocations 使用分摊的损益事实表</h3> <h3 id="multiple-currency-facts-多货币事实"><a href="#multiple-currency-facts-多货币事实" class="header-anchor">#</a> Multiple Currency Facts 多货币事实</h3> <h3 id="multiple-units-of-measure-facts-多度量单位事实"><a href="#multiple-units-of-measure-facts-多度量单位事实" class="header-anchor">#</a> Multiple Units of Measure Facts 多度量单位事实</h3> <h3 id="year-to-date-facts-年初至今事实"><a href="#year-to-date-facts-年初至今事实" class="header-anchor">#</a> Year-to-Date Facts 年初至今事实</h3> <h3 id="multipass-sql-to-avoid-fact-to-fact-table-joins-避免事实表之间连接的多遍sql"><a href="#multipass-sql-to-avoid-fact-to-fact-table-joins-避免事实表之间连接的多遍sql" class="header-anchor">#</a> Multipass SQL to Avoid Fact-to-Fact Table Joins 避免事实表之间连接的多遍SQL</h3> <h3 id="timespan-tracking-in-fact-tables-事实表中的时间跨度跟踪"><a href="#timespan-tracking-in-fact-tables-事实表中的时间跨度跟踪" class="header-anchor">#</a> Timespan Tracking in Fact Tables 事实表中的时间跨度跟踪</h3> <h3 id="late-arriving-facts-迟到事实"><a href="#late-arriving-facts-迟到事实" class="header-anchor">#</a> Late Arriving Facts 迟到事实</h3> <h2 id="advanced-dimension-techniques-高级维度技术"><a href="#advanced-dimension-techniques-高级维度技术" class="header-anchor">#</a> Advanced Dimension Techniques 高级维度技术</h2> <h3 id="dimension-to-dimension-table-joins-维度到维度表连接"><a href="#dimension-to-dimension-table-joins-维度到维度表连接" class="header-anchor">#</a> Dimension-to-Dimension Table Joins 维度到维度表连接</h3> <h3 id="multivalued-dimensions-and-bridge-tables-多值维度和桥接表"><a href="#multivalued-dimensions-and-bridge-tables-多值维度和桥接表" class="header-anchor">#</a> Multivalued Dimensions and Bridge Tables 多值维度和桥接表</h3> <h3 id="time-varying-multivalued-bridge-tables-时变多值桥接表"><a href="#time-varying-multivalued-bridge-tables-时变多值桥接表" class="header-anchor">#</a> Time Varying Multivalued Bridge Tables 时变多值桥接表</h3> <h3 id="behavior-tag-time-series-行为标签时间序列"><a href="#behavior-tag-time-series-行为标签时间序列" class="header-anchor">#</a> Behavior Tag Time Series 行为标签时间序列</h3> <h3 id="behavior-study-groups-行为研究组"><a href="#behavior-study-groups-行为研究组" class="header-anchor">#</a> Behavior Study Groups 行为研究组</h3> <h3 id="aggregated-facts-as-dimension-attributes-聚合事实作为维度属性"><a href="#aggregated-facts-as-dimension-attributes-聚合事实作为维度属性" class="header-anchor">#</a> Aggregated Facts as Dimension Attributes 聚合事实作为维度属性</h3> <h3 id="dynamic-value-bands-动态值带"><a href="#dynamic-value-bands-动态值带" class="header-anchor">#</a> Dynamic Value Bands 动态值带</h3> <h3 id="text-comments-dimension-文本注释维度"><a href="#text-comments-dimension-文本注释维度" class="header-anchor">#</a> Text Comments Dimension 文本注释维度</h3> <h3 id="multiple-time-zones-多个时区"><a href="#multiple-time-zones-多个时区" class="header-anchor">#</a> Multiple Time Zones 多个时区</h3> <h3 id="measure-type-dimensions-度量类型维度"><a href="#measure-type-dimensions-度量类型维度" class="header-anchor">#</a> Measure Type Dimensions 度量类型维度</h3> <h3 id="step-dimensions-步骤维度"><a href="#step-dimensions-步骤维度" class="header-anchor">#</a> Step Dimensions 步骤维度</h3> <h3 id="hot-swappable-dimensions-热插拔维度"><a href="#hot-swappable-dimensions-热插拔维度" class="header-anchor">#</a> Hot Swappable Dimensions 热插拔维度</h3> <h3 id="abstract-generic-dimensions-抽象通用维度"><a href="#abstract-generic-dimensions-抽象通用维度" class="header-anchor">#</a> Abstract Generic Dimensions 抽象通用维度</h3> <h3 id="audit-dimensions-审计维度"><a href="#audit-dimensions-审计维度" class="header-anchor">#</a> Audit Dimensions 审计维度</h3> <h3 id="late-arriving-dimensions-迟到维度"><a href="#late-arriving-dimensions-迟到维度" class="header-anchor">#</a> Late Arriving Dimensions 迟到维度</h3> <h2 id="special-purpose-schemas-特殊目的模式"><a href="#special-purpose-schemas-特殊目的模式" class="header-anchor">#</a> Special Purpose Schemas 特殊目的模式</h2> <p>以下设计模式用于特定的用例场景。</p> <h3 id="supertype-and-subtype-schemas-for-heterogeneous-products-异构产品的超类型和子类型模式"><a href="#supertype-and-subtype-schemas-for-heterogeneous-products-异构产品的超类型和子类型模式" class="header-anchor">#</a> Supertype and Subtype Schemas for Heterogeneous Products 异构产品的超类型和子类型模式</h3> <p>金融服务和其他行业经常提供多种不同业务线的产品。例如，一家零售银行可能提供从支票账户、抵押贷款到商业贷款等数十种账户类型，但它们都属于账户范畴。试图构建一个包含所有产品可能事实的单一综合事实表，并将其与包含这些不同产品所有可能属性的维度表相连接，这种做法往往会失败，因为可能存在数百个不兼容的事实和属性。解决办法是构建一个单一的超类型事实表，其中包含所有账户类型事实的交集（同时构建一个包含公共属性的超类型维度表），然后为每个子类型系统地构建单独的事实表（以及相关的维度表）。超类型和子类型事实表也被称为核心和定制事实表。</p> <h3 id="real-time-fact-tables-实时事实表"><a href="#real-time-fact-tables-实时事实表" class="header-anchor">#</a> Real-Time Fact Tables 实时事实表</h3> <p>实时事实表需要比传统的夜间批量处理更频繁地更新。根据用于最终部署到BI报告层的数据库管理系统（DBMS）或OLAP立方体的功能，有多种技术可满足这一要求。例如，可以在事实表上定义一个 “热分区”，将其固定在物理内存中，且该分区不构建聚合和索引。其他DBMS或OLAP立方体可能支持延迟更新，允许现有查询运行完成后再执行更新操作。</p> <h3 id="error-event-schemas-错误事件模式"><a href="#error-event-schemas-错误事件模式" class="header-anchor">#</a> Error Event Schemas 错误事件模式</h3> <p>在数据仓库中管理数据质量，需要一个全面的数据质量筛选或过滤系统，在数据从源系统流向BI平台的过程中对其进行测试。当数据质量筛选器检测到错误时，该事件会记录在一个特殊的维度模式中，这个模式仅在ETL后台可用。该模式由一个错误事件事实表和一个相关的错误事件详细事实表组成，错误事件事实表的粒度为单个错误事件，而错误事件详细事实表的粒度为参与错误事件的每个表中的每一列。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blankornotes/ch1.html" class="prev">
        第一章
      </a></span> <span class="next"><a href="/blankornotes/ch3.html">
        第三章
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blankornotes/assets/js/app.14282ac1.js" defer></script><script src="/blankornotes/assets/js/2.a76d4e78.js" defer></script><script src="/blankornotes/assets/js/1.2ec8c7d7.js" defer></script><script src="/blankornotes/assets/js/24.5f4024fd.js" defer></script>
  </body>
</html>
